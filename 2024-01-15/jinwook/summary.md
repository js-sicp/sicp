# 태그된 데이터

- 데이터 추상화는 구체에 대한 결정을 최대한 미룰 수 있다. (사전 결정 최소화)
- 극단적으로는 선택자, 생성자를 설계한 이후까지 표현의 중의성을 남겨둘 수 있다. (2가지 표현이 공존할 수 있다.)
- 공존하는 두 표현을 하나의 시스템에 포함시키기 위해서는 표현을 식별하는 수단이 필요하다. (type tag)
  - 태그와 내용을 결합하는 생성자 함수, 각각에 접근할 수 있는 접근자 함수를 정의한다.
  - 각 일반적 연산에 대한 표현별 함수를 정의한다. 함수명이 중복되지 않도록 표현에 대한 내용을 접미사를 이용한다.
  - 일반적 연산에 대해서 태그를 활용하여 해당 표현의 함수를 호출한다.

# 데이터 지향적 프로그래밍과 가산성

- 데이터의 형식을 점검해서 적절한 함수를 호출하는 전략을 형식 기반 디스패치라고 한다.
- 일반적 연산을 담당하는 함수에서 태그를 식별하고 그에 따른 표현별 함수를 호출하는 전략은 가산성에 문제가 있다.
  - 새로운 표현이 생길 경우, 모든 일반적 연산을 담당하는 함수에서 새로운 표현을 식별하고 올바른 함수를 호출해주어야 한다.
  - 함수의 이름이 중복되지 않아야 하기에, 표현별 함수에 접미사가 붙어야한다. 이는 이름 충돌을 피하기 위해 코드를 수정할 가능성이 생긴다.
  - 시스템의 규모가 크면 클수록 가산성의 문제는 더더욱 심각해진다.
- 데이터 지향적 프로그래밍 기법을 활용하면 위의 문제를 해결할 수 있다.
  - 일반적 연산 내에는 표현을 태그에 따라 식별하는 코드가 존재한다. 이는 일반적 연산과, 표현별 함수를 각각의 축으로 한 2차원 테이블 내 항목을 조건문 코드를 통해 찾아가는 것과 동일하다.
  - 테이블을 직접 사용하는 방식으로 프로그램을 설계한다면, 새로운 표현이 생긴다면 테이블에 등록만 해주면 된다. 일반적 연산에 대한 코드의 수정이 불필요하다.
  - 새로운 표현은 모든 일반적 연산에 대해서 테이블에 등록을 해주어야한다. 누락이 발생하면 안되며 가능성이 있다. 이 관점에서 봤을 때 인터페이스를 정의하고 인터페이스를 준수하는 객체를 만드는 방식으로 다형성을 구현하는 OOP도 좋은 것 같다.
    - 테이블에 등록하는 시점에, 올바르게 등록이 되었는지 판단하는 함수가 있다면 또 해결할 수 있는 문제이다.
